# RAG ัะธััะตะผะฐ ะดะปั ัะธะฝะฐะฝัะพะฒะพะน ะณัะฐะผะพัะฝะพััะธ

ะกะธััะตะผะฐ Retrieval-Augmented Generation (RAG) ะดะปั ะพัะฒะตัะพะฒ ะฝะฐ ะฒะพะฟัะพัั ะฟะพ ัะธะฝะฐะฝัะพะฒะพะน ะณัะฐะผะพัะฝะพััะธ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะปะพะบะฐะปัะฝะพะน ะผะพะดะตะปะธ ัะผะฑะตะดะดะธะฝะณะพะฒ, ะฒะตะบัะพัะฝะพะน ะฑะฐะทั ะดะฐะฝะฝัั FAISS ะธ LLM ะพั Perplexity AI.

## ะะฟะธัะฐะฝะธะต ะบะพะดะฐ

ะัะพะตะบั ัะตะฐะปะธะทัะตั ััะธ ะฒะฐัะธะฐะฝัะฐ RAG-ะฟะฐะนะฟะปะฐะนะฝะฐ ั ะฒะพะทัะฐััะฐััะตะน ัะปะพะถะฝะพัััั ะธ ัะพัะฝะพัััั:

- **V1 (Doc-level):** ะัะพััะฐั ะฒะตะบัะพัะธะทะฐัะธั ัะตะปัั ะดะพะบัะผะตะฝัะพะฒ
- **V2 (Chunking):** ะะฐะทะฑะธะตะฝะธะต ะดะพะบัะผะตะฝัะพะฒ ะฝะฐ ััะฐะณะผะตะฝัั ะดะปั ัะพัะฝะพะณะพ ะฟะพะธัะบะฐ
- **V3 (Chunking + Reranking):** ะัะพะดะฒะธะฝััะฐั ะฒะตััะธั ั ะฟะตัะตัะฐะฝะถะธัะพะฒะฐะฝะธะตะผ ัะตัะตะท LLM

### ะัะพะฑะตะฝะฝะพััะธ

ะกะธััะตะผะฐ ะธัะฟะพะปัะทัะตั ะปะพะบะฐะปัะฝัั ะผะพะดะตะปั ัะผะฑะตะดะดะธะฝะณะพะฒ `paraphrase-multilingual-MiniLM-L12-v2` ะดะปั ะฒะตะบัะพัะธะทะฐัะธะธ ัะตะบััะพะฒ ะธ ะฒะตะบัะพัะฝัั ะฑะฐะทั ะดะฐะฝะฝัั FAISS ะดะปั ะฑััััะพะณะพ ัะตะผะฐะฝัะธัะตัะบะพะณะพ ะฟะพะธัะบะฐ.

---

## ะััะธัะตะบัััะฐ ัะธััะตะผั
### ะะพะผะฟะพะฝะตะฝัั ะฟะฐะนะฟะปะฐะนะฝะฐ

โโโโโโโโโโโโโโโโโโโ
โ ะะพะฟัะพั โ
โโโโโโโโโโฌโโโโโโโโโ
โ
โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Sentence-Transformers โ โ ะะพะบะฐะปัะฝะฐั ะผะพะดะตะปั ัะผะฑะตะดะดะธะฝะณะพะฒ
โ (MiniLM-L12-v2) โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
โ embedding (384 dim)
โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ FAISS IndexFlatIP โ โ ะะตะบัะพัะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั
โ (4291+ ะฒะตะบัะพัะพะฒ) โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
โ top_k ัะตะทัะปััะฐัะพะฒ
โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Reranker (ัะพะปัะบะพ V3) โ โ LLM ะฟะตัะตัะฐะฝะถะธัะพะฒะฐะฝะธะต
โ Perplexity Sonar โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
โ final_k ััะฐะณะผะตะฝัะพะฒ
โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะพัััะพะตะฝะธะต ะบะพะฝัะตะบััะฐ โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
โ
โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะตะฝะตัะฐัะธั ะพัะฒะตัะฐ โ โ LLM (Perplexity Sonar)
โ Perplexity Sonar โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
โ
โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ LLM-as-a-Judge โ โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะตะฝะบะฐ
โ (Relevance + Faith.) โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ


### ะะพัะตะผั V3 ะปัััะต?

1. **V1 ะฟัะพะฑะปะตะผะฐ**: ะะปะธะฝะฝัะต ะดะพะบัะผะตะฝัั ัะพะทะดะฐัั "ัะฐะทะผัััะต" ัะผะฑะตะดะดะธะฝะณะธ, ะณะดะต ะฒะฐะถะฝะฐั ะดะตัะฐะปั ัะตััะตััั ััะตะดะธ ะพะฑัะตะณะพ ัะตะบััะฐ.
2. **V2 ัะตัะตะฝะธะต**: ะะฐะทะฑะธะฒะบะฐ ะฝะฐ ัะฐะฝะบะธ ะฝะฐัะพะดะธั ะบะพะฝะบัะตัะฝัะต ััะฐะณะผะตะฝัั, ะฝะพ ะฒะตะบัะพัะฝัะน ะฟะพะธัะบ ะธะฝะพะณะดะฐ ะพัะธะฑะฐะตััั ะธะท-ะทะฐ ัะธะฝะพะฝะธะผะพะฒ ะธะปะธ ัะปะพะถะฝัั ัะพัะผัะปะธัะพะฒะพะบ.
3. **V3 ะฟัะตะธะผััะตััะฒะพ**: LLM "ะฟะตัะตัะธััะฒะฐะตั" ัะพะฟ-20 ะบะฐะฝะดะธะดะฐัะพะฒ ะธ ะฒัะฑะธัะฐะตั ัะตะฐะปัะฝะพ ัะตะปะตะฒะฐะฝัะฝัะต 3, ะธัะฟัะฐะฒะปัั ะพัะธะฑะบะธ ะฒะตะบัะพัะฝะพะณะพ ะฟะพะธัะบะฐ.


ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

- **Embeddings**: `sentence-transformers` (paraphrase-multilingual-MiniLM-L12-v2)
- **Vector DB**: `faiss-cpu` (IndexFlatIP ะดะปั ะบะพัะธะฝััะฝะพะณะพ ััะพะดััะฒะฐ)
- **LLM**: Perplexity API (llama-3.1-sonar-small-128k-chat)
- **ะะฝััะฐััััะบัััะฐ**: Docker
- **ะฏะทัะบ**: Python 3.11


## ะฃััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ
docker build -t finance-news .
docker run --rm -v "${PWD}:/app" --env-file .env finance-news --mode v3 --limit 30

- `--mode`: ะะตะถะธะผ ัะฐะฑะพัั (`v1`, `v2`, `v3`)
- `--limit`: ะะณัะฐะฝะธัะตะฝะธะต ะบะพะปะธัะตััะฒะฐ ะฒะพะฟัะพัะพะฒ ะดะปั ะพะฑัะฐะฑะพัะบะธ (ะดะปั ัะตััะธัะพะฒะฐะฝะธั)


## ๐ ะะตััะธะบะธ ะบะฐัะตััะฒะฐ

ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะตะฝะธะฒะฐะตั ะบะฐะถะดัะน ะพัะฒะตั ะฟะพ ะดะฒัะผ ะผะตััะธะบะฐะผ (ัะบะฐะปะฐ 1-5):

### 1. **Relevance (ะะตะปะตะฒะฐะฝัะฝะพััั)**
ะะฐัะบะพะปัะบะพ ะพัะฒะตั ัะพะพัะฒะตัััะฒัะตั ะฒะพะฟัะพัั?
- 5: ะะพะปะฝัะน ะธ ัะพัะฝัะน ะพัะฒะตั
- 3: ะงะฐััะธัะฝัะน ะพัะฒะตั
- 1: ะะต ะพัะฒะตัะฐะตั ะฝะฐ ะฒะพะฟัะพั

### 2. **Faithfulness (ะคะฐะบัะธัะตัะบะฐั ัะพัะฝะพััั)**
ะะฐัะบะพะปัะบะพ ะพัะฒะตั ะพัะฝะพะฒะฐะฝ ะฝะฐ ะฟัะตะดะพััะฐะฒะปะตะฝะฝะพะผ ะบะพะฝัะตะบััะต ะฑะตะท ะณะฐะปะปััะธะฝะฐัะธะน?
- 5: ะะพะปะฝะพัััั ะฟะพะดัะฒะตัะถะดะฐะตััั ะบะพะฝัะตะบััะพะผ
- 3: ะงะฐััะธัะฝะพ ะฟะพะดัะฒะตัะถะดะฐะตััั
- 1: ะัะดัะผัะฒะฐะตั ัะฐะบัั

### Baseline ัะตะทัะปััะฐัั (30 ะฒะพะฟัะพัะพะฒ, ัะตะถะธะผ V3)

Relevance: 2.60 / 5.00
Faithfulness: 3.40 / 5.00

**ะะฝัะตัะฟัะตัะฐัะธั**: ะกะธััะตะผะฐ ัะพัะพัะพ ะฟัะธะดะตัะถะธะฒะฐะตััั ัะฐะบัะพะฒ (Faithfulness 3.4), ะฝะพ ะธะฝะพะณะดะฐ ะฝะต ะฟะพะปะฝะพัััั ะพัะฒะตัะฐะตั ะฝะฐ ะฒะพะฟัะพั (Relevance 2.6). ะญัะพ ัะฒัะทะฐะฝะพ ั ะพะณัะฐะฝะธัะตะฝะธัะผะธ ัะฐะทะผะตัะฐ ัะฐะฝะบะพะฒ (1000 ัะธะผะฒะพะปะพะฒ) ะธ ัะปะพะถะฝะพัััั ัะธะฝะฐะฝัะพะฒัั ัะตะผ.
